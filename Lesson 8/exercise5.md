# PowerShell

## Что такое PowerShell?

**Windows PowerShell** — это одновременно командная оболочка и язык сценариев, основанный на .NET.    
PowerShell используют для управления компьютером и автоматизации задач.    
Это полноценный объектно-ориентированный язык, в котором есть переменные, функции, классы и объекты.В отличие от других командных оболочек, PowerShell работает не со строками, а с объектами. Благодаря этому можно создавать сложную логику. При этом интерпретатор полностью совместим со стандартными командами cmd.exe и может выполнять их.Команды пишут в интерактивном режиме внутри терминала.

## Какие возможности имеет PowerShell?

В отличие от принимающих и возвращающих текстовые данные оболочек, Windows PowerShell работает с классами .NET, у которых есть свойства и методы. PowerShell позволяет выполнять обычные команды, а также дает доступ к объектам COM, WMI и ADSI. В ней используются различные хранилища, вроде файловой системы или реестра Windows, для доступа к которым созданы т.н. поставщики (providers).     
Стоит отметить возможность встраивания исполняемых компонентов PowerShell в другие приложения для реализации различных операций, в т.ч. через графический интерфейс. Mногие приложения для Windows предоставляют доступ к своим интерфейсам управления через PowerShell. 

Windows PowerShell позволяет:

- Менять настройки операционной системы;
- Управлять службами и процессами;
- Настраивать роли и компоненты сервера;
- Устанавливать программное обеспечение;
- Управлять установленным ПО через специальные интерфейсы;
- Встраивать исполняемые компоненты в сторонние программы;
- Создавать сценарии для автоматизации задач администрирования;
- Работать с файловой системой, реестром Windows, хранилищем сертификатов и т.д

## Как открыть журнал событий в PowerShell?

Есть два основных способа открыть PowerShell  в Windows: меню «Пуск» и приложение «Выполнить».

1. В меню «Пуск» долистайте до папки Windows PowerShell, откройте её и выберите нужное приложение. Здесь есть 32-разрядные (у них х86 в скобках) и 64-разрядные версии терминала 

2. Приложение «Выполнить» открывается сочетанием клавиш Win + R. В появившемся окне введите **powershell** и нажмите ОК.

## Чем cmd отличается от PowerShell?

Разница между CMD и PowerShell заключается в том, что CMD — это «традиционный» стиль командной строки или интерактивной оболочки. Он очень удобен в использовании, и тысячи людей могут его без проблем выполнить. С другой стороны, PowerShell — это встроенная, но сложная программа командной строки Microsoft, которая значительно уступает оболочкам, доступным для систем на базе Linux или Unix. Большинство команд командной строки легко использовать в PowerShell изначально или через псевдонимы.

На протяжении многих лет было много споров о точном происхождении PowerShell. Он был разработан как замена интерфейса командной строки, поставляемого с системами UNIX, чтобы системные администраторы могли сэкономить свое драгоценное время и автоматизировать задачи администрирования. Нет никаких сомнений в том, что PowerShell стал неотъемлемой частью нашего компьютерного опыта.

CMD или «интерфейс командной строки» — это не что иное, как серия простых команд. Эти команды позволяют выполнять простые административные задачи и взаимодействовать с любым объектом Windows в операционных системах Microsoft Windows. Напротив, интерфейс командной строки PowerShell позволит вам выполнять более сложные задачи и сложные сценарии.

PowerShell делится на две основные категории: «Обычные» и «Особые». Типичный интерфейс PowerShell не имеет особых возможностей. Точно так же CMD разбита на серию команд. Итак, в чем разница между PowerShell и cmd?

<table>
	<tbody>
		<tr>
			<td>PowerShell</td>
			<td>Командная строка</td>
		</tr>
		<tr>
			<td>PowerShell был представлен в 2006 году.	</td>
			<td>CMD был представлен в 1981 году.</td>
		</tr>
		<tr>
			<td>Вы можете запустить его, набрав PowerShell.</td>
			<td>Вы можете запустить его, набрав CMD.</td>
		</tr>
		<tr>
			<td>Он поддерживает как пакетные, так и команды PowerShell.</td>
			<td>На CMD следует запускать только пакетные команды.</td>
		</tr>
		<tr>
			<td>Он также поддерживает создание псевдонимов для командлетов, чтобы пользователи могли легко перемещаться между функциями.</td>
			<td>CMD не может создавать псевдонимы команд.</td>
		</tr>
		<tr>
			<td>У вас есть свобода передавать выходные данные командлета другому командлету.	</td>
			<td>Вы никогда не сможете передать результат одной команды другой.</td>
		</tr>
		<tr>
			<td>PowerShell возвращает результат в виде объекта.</td>
			<td>CMD возвращает только текст.
	</td>
		</tr>
		<tr>
			<td>Мы можем запустить последовательность командлетов в сценарии.</td>
			<td>В cmd вторая команда будет запущена, если первая команда будет завершена.
	</td>
		</tr>
		<tr>
			<td>Вы можете использовать команду Help, чтобы с легкостью получить информацию о любых командлетах.	</td>
			<td>В CMD нет такой опции помощи.
PowerShell имеет интегрированную среду сценариев (ISE).	Это просто интерфейс командной строки.</td>
		</tr>
		<tr>
			<td>Вы можете получить доступ к библиотекам программирования, потому что они построены на основе .NET Common Language Runtime (CLR).</td>
			<td>Нет доступа к библиотекам</td>
		</tr>
		<tr>
			<td>Вы можете напрямую интегрировать его с WMI.</td>
			<td>Если вам нужна интеграция с WMI, вам потребуются внешние плагины.</td>
		</tr>
		<tr>
			<td>С облачными продуктами Microsoft проще подключиться.</td>
			<td>CMD не может подключиться к продуктам Microsoft Online.</td>
		</tr>
		<tr>
			<td>Он поддерживает системы Linux.</td>
			<td>CMD не поддерживает системы Linux.</td>
		</tr>
		<tr>
			<td>Вы можете запускать все типы программ с помощью PowerShell.	</td>
			<td>ssCMD предназначен только для программ консольного типа.</td>
		</tr>
	</tbody>
</table>


## Какой командой в PowerShell можно просмотреть список доступных журналов событий?

Журнал событий Windows PowerShell можно просмотреть в Просмотр событий или с помощью Get-EventLog командлетов и Get-WmiObject . Чтобы просмотреть содержимое журнала Windows PowerShell, введите следующее:



` Get-EventLog -LogName "Windows PowerShell"`

Чтобы изучить события и их свойства, используйте Sort-Object командлет, Group-Object командлет и командлеты, содержащие Format команду ( Format командлеты ).

Например, чтобы просмотреть события в журнале, сгруппированные по идентификатору события, введите:

` Get-EventLog "Windows PowerShell" | Format-Table -GroupBy EventID`

Или введите:

```
Get-EventLog "Windows PowerShell" |
  Sort-Object EventID |
  Group-Object EventID
```


Чтобы просмотреть все классические журналы событий, введите:

`Get-EventLog -List`

Вы также можете использовать Get-WmiObject командлет , чтобы использовать связанные с событиями классы инструментария управления Windows (WMI) для проверки журнала событий. Например, чтобы просмотреть все свойства файла журнала событий, введите:


```
Get-WmiObject Win32_NTEventlogFile |
  where LogFileName -EQ "Windows PowerShell" |
  Format-List -Property *
  
```

Чтобы найти классы WMI, связанные с событиями Win32, введите:

`Get-WmiObject -List | where Name -Like "win32*event*"`

Для получения дополнительных сведений введите `Get-Help Get-EventLog и Get-Help Get-WmiObject`.


## Какой командой можно узнать текущую версию PowerShell?

Самый простой способ определить какая версия PowerShell у вас установлена с помощью команды:

**host**  или

**$PSVersionTable**

Можно получить только значении версии:

**$PSVersionTable.PSVersion.major**

Для получения версии PowerShell на удаленных компьютерах нужно использовать значение переменной окружения $PSVersionTable или получать данные непосредственно из реестра. Другие способы могут возвращать некорректные данные.

Вы можете получить версию PowerShell с удаленного компьютера с помощью команды Invoke-Command:

Invoke-Command -ComputerName dc01 -ScriptBlock {$PSVersionTable.PSVersion} -Credential $cred

