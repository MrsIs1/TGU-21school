# Задание №7. Нагрузка, стресс и отказоустойчивость

## 1. Что такое нагрузочное тестирование, тестирование отказоустойчивости и стресс-тестирование? Что их отличает друг от друга?

## Нагрузочное тестирование
Нагрузочное тестирование предназначено для оценки производительности и стабильности системы при нагрузке, близкой к предельным значениям или превышающей их. Цель нагрузочного тестирования - проверить, как система справляется с пиковыми нагрузками и определить ее пропускную способность и границы устойчивости.

Примеры нагрузочного тестирования могут включать сценарии, в которых множество пользователей одновременно выполняют запросы к системе или обрабатывается большой объем данных. Результаты тестирования могут помочь определить оптимальные настройки системы, выявить проблемы производительности, бутылочные горлышки и потенциальные узкие места.

## Тестирование отказоустойчивости
Тестирование отказоустойчивости направлено на проверку поведения системы в условиях отказов и непредвиденных сбоев. Цель такого тестирования - убедиться, что система может успешно восстановиться после отказа и продолжить свою работу с минимальным влиянием на пользователей и бизнес-процессы.

В ходе тестирования отказоустойчивости, выполняются сценарии, имитирующие отказы серверов, сбои в сети, сбои в питании или другие ситуации, которые могут повлиять на работу системы. Тестирование отказоустойчивости позволяет выявить слабые места системы, недостаточную резервированность и возможные проблемы при восстановлении после сбоев.

## Стресс-тестирование
Стресс-тестирование направлено на проверку стабильности и надежности системы при экстремальных условиях, когда ресурсы системы исчерпаны или превышены их предельные значения. Цель стресс-тестирования - узнать, как система ведет себя при перегрузке и проверить, сохраняет ли она корректное функционирование и данные при таких условиях.

Примеры стресс-тестирования могут включать сценарии, в которых система подвергается очень высокой нагрузке, обработке большого объема данных или продолжительным сессиям использования. Тестирование стресса позволяет выявить слабые места системы, предотвратить потенциальные сбои или потерю данных при экстремальных нагрузках и определить максимальные границы ее стабильности.

**Вот основные отличия между этими видами тестирования:**

- Нагрузочное тестирование оценивает производительность и стабильность системы при нагрузке, близкой к предельным значениям или превышающей их.
- Тестирование отказоустойчивости проверяет поведение системы в условиях отказов и непредвиденных сбоев, и ее способность восстановиться после отказа.
- Стресс-тестирование проверяет стабильность и надежность системы при экстремальных условиях, когда ресурсы исчерпаны или превышены их предельные значения.
- Каждый из этих видов тестирования имеет свою специфику и направлен на проверку разных аспектов системы под различными условиями нагрузки и сбоев.
___

## 2. Приведите по одному примеру выполнения каждого из трёх видов тестирования (в контексте проверки базы данных большого веб-приложения).

## Нагрузочное тестирование

Пример нагрузочного тестирования базы данных веб-приложения может быть следующим:

1. Установка нагрузки: Запуск сценария, имитирующего одновременные запросы от множества пользователей к базе данных.
2. Увеличение нагрузки: Постепенное увеличение количества запросов или частоты запросов для проверки пропускной способности базы данных.
3. Мониторинг производительности: Оценка времени выполнения запросов, нагрузки на ресурсы сервера баз данных (CPU, память, дисковое пространство) и других метрик производительности.
4. Анализ результатов: Идентификация возможных узких мест, бутылочных горлышек или проблем производительности. Определение границ устойчивости системы при данной нагрузке.

## Тестирование отказоустойчивости

Пример тестирования отказоустойчивости базы данных веб-приложения может быть следующим:
1. Создание сценария: Подготовка сценария, в котором имитируются отказы в работе сервера базы данных, сбои в сети или другие непредвиденные ситуации.
2. Имитация отказа: Запуск сценария, в котором происходят отказы сервера базы данных или сбои в сети для проверки поведения веб-приложения и его способности восстановиться.
3. Мониторинг и резервирование: Оценка времени восстановления, проверка работы механизмов резервирования базы данных (например, репликация, шардинг) и анализ влияния отказов на работу веб-приложения.
4. Анализ результатов: Идентификация проблем при восстановлении после отказов, определение эффективности механизмов резервирования и оценка влияния отказов на пользователей и бизнес-процессы.

## Стресс-тестирование

Пример стресс-тестирования базы данных веб-приложения может быть следующим:
1. Создание экстремальных условий: Запуск сценария, в котором система подвергается экстремально высокой нагрузке или обработке большого объема данных.
2. Мониторинг ресурсов: Оценка использования ресурсов сервера базы данных (CPU, память, дисковое пространство) и других метрик производительности при экстремальных условиях.
3. Проверка стабильности: Проверка сохранения корректного функционирования базы данных, отсутствия потери данных и продолжения работы веб-приложения при перегрузке.
4. Анализ результатов: Идентификация слабых мест, потенциальных сбоев или потери данных при экстремальных нагрузках. Определение максимальных границ стабильности системы.


## 3.   __С помощью каких инструментов можно провести нагрузочное тестирование базы данных?__

Рынок программного обеспечения сегодня полон различных инструментов нагрузочного тестирования, начиная от приложений с открытым исходным кодом и заканчивая инструментами для автоматизированного нагрузочного тестирования премиум-класса. Тем не менее, имея такое количество доступных вариантов, иногда трудно выбрать лучший инструмент нагрузочного тестирования. 

__Инструменты нагрузочного тестирования с открытым исходным кодом__ бесплатны. Кроме того, пользователь может манипулировать используемым кодом и подгонять его в соответствии со своими потребностями. Но для этого пользователю, возможно, придется инвестировать в оборудование, чтобы запустить его на своих серверах. Это также может вызвать разочарование, потому что, поскольку они имеют открытый исходный код, эти инструменты поставляются без платной поддержки, чтобы ответить на вопросы, которые могут у вас возникнуть.

Премия, которую вы платите за платные инструменты нагрузочного тестирования, обычно имеет преимущества. **Разница между платными инструментами нагрузочного тестирования и бесплатными инструментами нагрузочного тестирования заключается в стоимости, которую вы заплатите за все дополнительные инструменты, которые могут вам понадобиться для тестирования** Поэтому бесплатные инструменты нагрузочного тестирования могут быть несвободными, учитывая затраты, связанные с настройкой тестирования. Бесплатные инструменты нагрузочного тестирования также сопряжены с тяжелым бременем создания только идеальных сценариев, тогда как оплата этих дополнительных денег платными инструментами нагрузочного тестирования может оказаться выгодной из-за их способности получать доступ к реальным сценариям.

Идеальной ситуацией было бы найти инструменты тестирования производительности, которые оснащены возможностью выполнять нагрузочное тестирование. Некоторые из этих платных программ нагрузочного тестирования имеют зонтичную организацию, в которой они работают, например, LoadView, который входит в состав Dotcom-Monitor, который предоставляет общие инструменты тестирования производительности. Найдя такую программу, вы не только даете себе возможность выполнять нагрузочные тесты, но и получаете информацию о производительности вашего сайта на основе данных.

Программное обеспечение с открытым исходным кодом может показаться привлекательным на первый взгляд из-за отсутствия первоначальных инвестиций, но как только вы начнете обходить его и применять к своей системе, вы можете обнаружить, что отсутствие первоначальных инвестиций перевернулось с ног на голову и заставило вас потратить больше, чем вы могли бы потратить на платный инструмент нагрузочного тестирования.

Инструменты нагрузочного тестирования с открытым исходным кодом трудно настроить. Кроме того, поскольку они являются пользовательским программным обеспечением, их пользовательский интерфейс может быть не идеальным или неподходящим для использования. Это дает возможность пользователю потратить больше времени, чем необходимо для настройки и запуска программы. Кроме того, определенное оборудование, которое вам может понадобиться для запуска этих программ, может быть недоступно для вас, и вам придется потратить деньги на их приобретение. В случае, если у вас есть оборудование, необходимое для запуска средств нагрузочного тестирования с открытым исходным кодом, вы можете обнаружить, что оно несовместимо с версией программного обеспечения, которое вы пытаетесь запустить. Отсутствие предлагаемой или доступной поддержки может быть еще одним способом, где вы можете рассмотреть возможность инвестирования в платные инструменты нагрузочного тестирования.

Есть еще один аспект инструментов нагрузочного тестирования с открытым исходным кодом, который часто упускается из виду; поскольку они имеют открытый исходный код и код генерируется пользователем, они могут служить для нарушения программного обеспечения, которое у вас уже есть. В таком случае для вашей помощи предоставляется ограниченная гарантия, а инструменты нагрузочного тестирования с открытым исходным кодом могут стать обузой.

Многие затраты связаны с инструментами нагрузочного тестирования с открытым исходным кодом, включая настройку, установку, обслуживание и поддержку. Все это приходит в дополнение к необходимости ознакомиться с языком программного обеспечения, чтобы вы могли работать с ним самостоятельно или обучать других этому.

Это приводит к выводу, что платные инструменты нагрузочного тестирования дороже, но могут сэкономить вам много затрат, связанных с бесплатными инструментами нагрузочного тестирования в долгосрочной перспективе. Это, конечно, вы получите в дополнение к удобному опыту, реальным сценариям и полной команде поддержки.

Инструменты:

- Apache JMeter
- LoadRunner
- LoadNinja
- WebLOAD
- LoadUI Pro
- BlazeMeter
- K6
- Яндекс.Танк
- Gatling
- Boomq.io

## 4. Какие существуют способы оптимизации (улучшения производительности) базы данных?

Оптимизация базы данных относится к процессу сокращения времени отклика системы базы данных. Это влечет за собой сокращение времени, необходимого для извлечения данных, и эффективности его выполнения.   

Основными направлениями повышения эффективности работы БД являются: оптимизация производительности БД, оптимизация кода, оптимизация работы СУБД, оптимизация структур данных, автоматизация мониторинга работы БД. Для оптимизации БД используется стандартизация, интеграция, консолидация, виртуализация данных и серверов, более тесная связь систем хранения с бизнес-процессами, автоматизация процессов обслуживания. Все это требует развитых программных средств, прежде всего, обеспечивающих эффективное управление хранением информации и автоматизацию всего жизненного цикла обработки информации. 
Рассмотрим подробнее некоторые из направлений оптимизации  БД:

1. **Оптимизация запросов**  
В большинстве случаев проблемы с производительностью вызваны низкой производительностью запросов. 
 
2.	**Создать оптимальные индексы**   
При правильной индексации можно оптимизировать продолжительность выполнения запроса и повысить общую производительность базы данных. Индексы достигают этого, внедряя структуру данных, которая помогает поддерживать порядок и облегчает поиск информации; в основном, индексирование ускоряет процесс поиска данных и делает его более эффективным.
 
3.	**Приобрести более мощный процессор**   
Чем лучше ваш процессор, тем быстрее и эффективнее будет ваша база данных. Поэтому, если ваша база данных работает не так, вы должны рассмотреть возможность обновления процессорного модуля более высокого класса; чем мощнее ваш процессор, тем меньше нагрузка при работе с несколькими приложениями и запросами. Кроме того, при оценке производительности ЦП важно отслеживать все аспекты производительности ЦП, в том числе время готовности ЦП (которое может рассказать вам о случаях, когда ваша система пыталась использовать ЦП, но не смогла, поскольку все ресурсы ЦП были слишком заняты или иным образом заняты).
 
4.	**Выделите больше памяти**   
Подобно тому, как недостаточно мощный процессор может повлиять на эффективность базы данных, так же как и нехватка памяти. В конце концов, когда в базе данных недостаточно памяти для выполнения запрашиваемой работы, производительность базы данных по понятным причинам пойдет на спад. По сути, наличие большего объема памяти поможет повысить эффективность системы и общую производительность. Хороший способ проверить, нужно ли вам больше памяти, — посмотреть, сколько ошибок в вашей системе имеет страница; Если количество сбоев велико (например, в тысячах), это означает, что вашим хостам не хватает (или, возможно, полностью не хватает) доступного пространства памяти. 
 
5.	**Дефрагментация данных**   
Если у вас проблемы с медленной базой данных, другим возможным решением является дефрагментация данных. Когда в базу данных записывается много записей и время идет, записи фрагментируются во внутренних файлах данных и на самом диске. Дефрагментация диска позволит сгруппировать соответствующие данные, поэтому операции, связанные с вводом/выводом, будут выполняться быстрее, что напрямую повлияет на общую производительность запросов и базы данных. Кроме того, на некотором связанном примечании также важно иметь достаточно дискового пространства вообще, работая с базой данных; если вы действительно хотите оптимизировать производительность базы данных, обязательно используйте дефрагментацию диска, сохраняя при этом достаточно свободного дискового пространства для вашей базы данных.
 
6.	**Типы дисков**   
Для извлечения результатов даже одного запроса могут потребоваться миллионы операций ввода-вывода с диска, в зависимости от объема данных, к которым запрос должен получить доступ для обработки, и в зависимости от объема данных, возвращаемых из запроса. Таким образом, тип дисков на вашем сервере может сильно повлиять на производительность ваших запросов. Работа с SSD-дисками может значительно повысить общую производительность базы данных и, в частности, производительность запросов.
 
7.	**Версия базы данных**   
Обновление последней версии базы данных может существенно повлиять на общую производительность базы данных. Возможно, что один запрос может работать лучше в старых версиях, чем в новых, но если посмотреть на общую производительность, новые версии, как правило, работают лучше.

